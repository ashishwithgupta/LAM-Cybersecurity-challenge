<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAM Cybersecurity Challenge - Admin Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            font-family: 'Arial', sans-serif;
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(45deg, #0d4f3c, #188167);
            padding: 20px;
            text-align: center;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .admin-title {
            font-size: 2.5em;
            color: #2c9f88;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .admin-subtitle {
            color: #40e0d0;
            font-size: 1.2em;
        }
        
        .panel-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .panel-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #40e0d0;
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }
        
        .panel-title {
            color: #40e0d0;
            font-size: 1.4em;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
        }
        
        .btn-success:hover {
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
        }
        
        .btn-info {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }
        
        .btn-info:hover {
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid #00ffff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #00ffff;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #b0c4de;
            margin-top: 5px;
        }
        
        .leaderboard-table {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .leaderboard-table th,
        .leaderboard-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .leaderboard-table th {
            background: rgba(0, 255, 255, 0.2);
            color: #00ffff;
            font-weight: bold;
        }
        
        .rank-1 { background: rgba(241, 196, 15, 0.2); }
        .rank-2 { background: rgba(149, 165, 166, 0.2); }
        .rank-3 { background: rgba(205, 127, 50, 0.2); }
        
        .export-area {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #40e0d0;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .warning {
            background: rgba(255, 193, 7, 0.2);
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: #ffc107;
        }
        
        .success {
            background: rgba(40, 167, 69, 0.2);
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: #28a745;
        }
        
        .game-link {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 10px;
            display: inline-block;
            font-weight: bold;
            margin: 20px 0;
            transition: all 0.3s ease;
        }
        
        .game-link:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4);
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="header">
            <h1 class="admin-title">üõ°Ô∏è LAM CYBERSECURITY CHALLENGE</h1>
            <p class="admin-subtitle">Admin Control Panel</p>
        </div>
        
        <div style="text-align: center; margin-bottom: 30px;">
            <a href="lam-cybersecurity-competition-game.html" class="game-link">üéÆ LAUNCH GAME</a>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalPlayers">0</div>
                <div class="stat-label">Total Players</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="highestScore">0</div>
                <div class="stat-label">Highest Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="averageScore">0</div>
                <div class="stat-label">Average Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="perfectScores">0</div>
                <div class="stat-label">Perfect Scores</div>
            </div>
        </div>
        
        <div class="panel-grid">
            <div class="panel-card">
                <h2 class="panel-title">üéÆ Game Management</h2>
                <button class="btn btn-success" onclick="refreshData()">üîÑ Refresh Data</button>
                <button class="btn btn-info" onclick="testGame()">üß™ Test Game</button>
                <br><br>
                <div class="warning">
                    <strong>‚ö†Ô∏è DANGER ZONE</strong><br>
                    Use these buttons carefully!
                </div>
                <button class="btn" onclick="clearLeaderboard()">üóëÔ∏è Clear Leaderboard</button>
                <button class="btn" onclick="clearAllData()">üí• Clear All Data</button>
            </div>
            
            <div class="panel-card">
                <h2 class="panel-title">üìä Data Export</h2>
                <button class="btn btn-info" onclick="exportLeaderboard()">üìã Export Leaderboard</button>
                <button class="btn btn-info" onclick="exportWinners()">üèÜ Export Top 5 Winners</button>
                <button class="btn btn-info" onclick="exportAllData()">üíæ Export All Data</button>
                <br><br>
                <textarea id="exportArea" class="export-area" placeholder="Exported data will appear here..." readonly></textarea>
            </div>
        </div>
        
        <div class="panel-card">
            <h2 class="panel-title">üèÜ Current Leaderboard</h2>
            <div id="leaderboardContainer">
                <table class="leaderboard-table" id="leaderboardTable">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Score</th>
                            <th>Completion Time</th>
                            <th>Correct Answers</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody">
                        <tr>
                            <td colspan="7" style="text-align: center; color: #bbb;">Loading...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        // Admin functions
        function refreshData() {
            loadLeaderboard();
            updateStats();
            showSuccess('Data refreshed successfully!');
        }
        
        function clearLeaderboard() {
            if (confirm('‚ö†Ô∏è Are you sure you want to clear the leaderboard? This cannot be undone!')) {
                localStorage.removeItem('lam_cyber_leaderboard');
                loadLeaderboard();
                updateStats();
                showSuccess('Leaderboard cleared successfully!');
            }
        }
        
        function clearAllData() {
            if (confirm('üí• WARNING: This will delete ALL player data and leaderboard! Are you absolutely sure?')) {
                if (confirm('üö® FINAL WARNING: This action is IRREVERSIBLE! Continue?')) {
                    // Clear leaderboard
                    localStorage.removeItem('lam_cyber_leaderboard');
                    
                    // Clear all individual player data
                    for (let i = localStorage.length - 1; i >= 0; i--) {
                        const key = localStorage.key(i);
                        if (key && key.startsWith('lam_cyber_')) {
                            localStorage.removeItem(key);
                        }
                    }
                    
                    loadLeaderboard();
                    updateStats();
                    showSuccess('All data cleared successfully! Game reset for event day.');
                }
            }
        }
        
        function testGame() {
            window.open('lam-cybersecurity-competition-game.html', '_blank');
        }
        
        function exportLeaderboard() {
            const leaderboard = JSON.parse(localStorage.getItem('lam_cyber_leaderboard') || '[]');
            const exportText = JSON.stringify(leaderboard, null, 2);
            document.getElementById('exportArea').value = exportText;
            showSuccess('Leaderboard data exported!');
        }
        
        function exportWinners() {
            const leaderboard = JSON.parse(localStorage.getItem('lam_cyber_leaderboard') || '[]');
            const winners = leaderboard.slice(0, 5);
            
            let winnerText = "üèÜ TOP 5 WINNERS - LAM CYBERSECURITY CHALLENGE\\n\\n";
            winners.forEach((winner, index) => {
                const timeFormatted = `${Math.floor(winner.timeTaken / 60)}:${(winner.timeTaken % 60).toString().padStart(2, '0')}`;
                winnerText += `${index + 1}. ${winner.name}\\n`;
                winnerText += `   Email: ${winner.email}\\n`;
                winnerText += `   Score: ${winner.score} points\\n`;
                winnerText += `   Time: ${timeFormatted}\\n`;
                winnerText += `   Correct: ${winner.completedItems}/15\\n\\n`;
            });
            
            document.getElementById('exportArea').value = winnerText;
            showSuccess('Top 5 winners exported for prize distribution!');
        }
        
        function exportAllData() {
            const leaderboard = JSON.parse(localStorage.getItem('lam_cyber_leaderboard') || '[]');
            const allData = {
                timestamp: new Date().toISOString(),
                totalPlayers: leaderboard.length,
                leaderboard: leaderboard,
                statistics: calculateStats(leaderboard)
            };
            
            document.getElementById('exportArea').value = JSON.stringify(allData, null, 2);
            showSuccess('Complete data export generated!');
        }
        
        function loadLeaderboard() {
            const leaderboard = JSON.parse(localStorage.getItem('lam_cyber_leaderboard') || '[]');
            const tbody = document.getElementById('leaderboardBody');
            
            if (leaderboard.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #bbb;">No players yet</td></tr>';
                return;
            }
            
            tbody.innerHTML = '';
            leaderboard.forEach((player, index) => {
                const row = document.createElement('tr');
                if (index < 3) {
                    row.classList.add(`rank-${index + 1}`);
                }
                
                const timeFormatted = `${Math.floor(player.timeTaken / 60)}:${(player.timeTaken % 60).toString().padStart(2, '0')}`;
                const dateFormatted = new Date(player.timestamp).toLocaleString();
                
                row.innerHTML = `
                    <td><strong>#${index + 1}</strong></td>
                    <td>${player.name}</td>
                    <td>${player.email}</td>
                    <td><strong>${player.score}</strong></td>
                    <td>${timeFormatted}</td>
                    <td>${player.completedItems}/15</td>
                    <td>${dateFormatted}</td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        function updateStats() {
            const leaderboard = JSON.parse(localStorage.getItem('lam_cyber_leaderboard') || '[]');
            const stats = calculateStats(leaderboard);
            
            document.getElementById('totalPlayers').textContent = stats.totalPlayers;
            document.getElementById('highestScore').textContent = stats.highestScore;
            document.getElementById('averageScore').textContent = stats.averageScore;
            document.getElementById('perfectScores').textContent = stats.perfectScores;
        }
        
        function calculateStats(leaderboard) {
            if (leaderboard.length === 0) {
                return {
                    totalPlayers: 0,
                    highestScore: 0,
                    averageScore: 0,
                    perfectScores: 0
                };
            }
            
            const totalScore = leaderboard.reduce((sum, player) => sum + player.score, 0);
            const perfectCount = leaderboard.filter(player => player.score === 375).length;
            
            return {
                totalPlayers: leaderboard.length,
                highestScore: Math.max(...leaderboard.map(p => p.score)),
                averageScore: Math.round(totalScore / leaderboard.length),
                perfectScores: perfectCount
            };
        }
        
        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success';
            successDiv.innerHTML = `<strong>‚úÖ ${message}</strong>`;
            document.body.insertBefore(successDiv, document.body.firstChild);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadLeaderboard();
            updateStats();
        });
        
        // Auto-refresh every 30 seconds
        setInterval(() => {
            loadLeaderboard();
            updateStats();
        }, 30000);
    </script>
</body>
</html>